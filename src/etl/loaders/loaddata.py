'''
Created on Feb 16, 2012

@author: Mudassar Ali
'''

import sys







try:
    import etl
except ImportError:
    import os

    
    # Get the absolute file path
    p = os.path.abspath(__file__)
    
    # Move 4 steps above. FIXME: This would change in case of relocation.
    for i in range(0, 3):
        p = os.path.split(p)[0]
    # Append to PYTHONPATH
    sys.path.append(p)
    
from etl.loaders.dumps import DumpLoader
from etl.loaders.mysql import MySqlLoader
from etl.config import logger
from etl.system.system import initialize


def loaddata_from_dump_to_mysql_and_clear_dumps(filenamelist=[]):
    try:
        loader = DumpLoader()
        mysqlloader = MySqlLoader()
        categories, items, itemsdetail, itemsbestmatch = loader.loaddumps_and_zip(filenamelist)
        mysqlloader.writedata(data=categories, datatype="categories")
        mysqlloader.writedata(data=items, datatype="item")
        mysqlloader.writedata(data=itemsdetail, datatype="itemdetail")
        mysqlloader.writedata(data=itemsbestmatch, datatype="bestmatch")
    except Exception, e:
        logger.exception(str(e))
    finally:
        pass
        loader.delete_files(filenamelist)


def clear_files(filenamelist=[]):
    loader = DumpLoader()
    loader.delete_files(filenamelist)
        
if __name__ == '__main__':
    initialize(Environment="DEVELOPMENT")
    filenamelist=['file_blueinconline@GB_GB__190726407298___bestmatch.txt', 'file_blueinconline_GB_155183__78_0_item.txt', 'file_blueinconline@GB_GB__200787216128___bestmatch.txt', 'file____200814928253___itemdetail.txt', 'file____200776872016___itemdetail.txt', 'file____200814884940___itemdetail.txt', 'file____190725707573___itemdetail.txt', 'file____190722155992___itemdetail.txt', 'file____320835010310___itemdetail.txt', 'file_blueinconline@GB_GB__200767952600___bestmatch.txt', 'file____200818720257___itemdetail.txt', 'file____200794596388___itemdetail.txt', 'file____190656453750___itemdetail.txt', 'file____200769243611___itemdetail.txt', 'file____200786834247___itemdetail.txt', 'file____200775522967___itemdetail.txt', 'file____320883576681___itemdetail.txt', 'file____190725590450___itemdetail.txt', 'file____200793514533___itemdetail.txt', 'file____200818252696___itemdetail.txt', 'file____190712201680___itemdetail.txt', 'file____320942295000___itemdetail.txt', 'file____320883457456___itemdetail.txt', 'file____320959113742___itemdetail.txt', 'file_blueinconline_GB_53120__11_0_item.txt', 'file____190714468260___itemdetail.txt', 'file____190698588478___itemdetail.txt', 'file____190661025456___itemdetail.txt', 'file____320881918184___itemdetail.txt', 'file____320981465429___itemdetail.txt', 'file_blueinconline@GB_GB__190699647760___bestmatch.txt', 'file____200794588637___itemdetail.txt', 'file____200790900466___itemdetail.txt', 'file____190718018164___itemdetail.txt', 'file____320930200656___itemdetail.txt', 'file____190687013680___itemdetail.txt', 'file____190725663637___itemdetail.txt', 'file____190718076475___itemdetail.txt', 'file____200747598799___itemdetail.txt', 'file____200787216128___itemdetail.txt', 'file____200816623302___itemdetail.txt', 'file____190723759277___itemdetail.txt', 'file____190725081809___itemdetail.txt', 'file_blueinconline@GB_GB__320938009603___bestmatch.txt', 'file____200809794015___itemdetail.txt', 'file_blueinconline_GB_11483__500_0_item.txt', 'file_blueinconline@GB_GB__200818720257___bestmatch.txt', 'file____190718081314___itemdetail.txt', 'file____320980199795___itemdetail.txt', 'file____190712968453___itemdetail.txt', 'file_blueinconline_GB_11498__94_0_item.txt', 'file____200786358527___itemdetail.txt', 'file____320938495344___itemdetail.txt', 'file____190661020160___itemdetail.txt', 'file____190703755259___itemdetail.txt', 'file_blueinconline_GB_63864__43_0_item.txt', 'file____190656518492___itemdetail.txt', 'file____200737019809___itemdetail.txt', 'file____190685554202___itemdetail.txt', 'file____320948572600___itemdetail.txt', 'file_blueinconline_GB_313__5_0_item.txt', 'file_blueinconline_GB_63869__144_0_item.txt', 'file_blueinconline@GB_GB__320924195456___bestmatch.txt', 'file____320974048804___itemdetail.txt', 'file____200822249929___itemdetail.txt', 'file____320964378781___itemdetail.txt', 'file____190688522692___itemdetail.txt', 'file____200815969137___itemdetail.txt', 'file____320981464315___itemdetail.txt', 'file____320939086674___itemdetail.txt', 'file____200796776927___itemdetail.txt', 'file____320928447264___itemdetail.txt', 'file_blueinconline@GB_GB__200793564423___bestmatch.txt', 'file____320980894107___itemdetail.txt', 'file____320916219405___itemdetail.txt', 'file____200743851726___itemdetail.txt', 'file____200764545882___itemdetail.txt', 'file_blueinconline@GB_GB__200807735809___bestmatch.txt', 'file____320882458025___itemdetail.txt', 'file____190723699149___itemdetail.txt', 'file____320964421260___itemdetail.txt', 'file_blueinconline@GB_GB__320931250740___bestmatch.txt', 'file____190725709804___itemdetail.txt', 'file____320982132613___itemdetail.txt', 'file____320937879139___itemdetail.txt', 'file_blueinconline_GB_11484__36_0_item.txt', 'file____200794580524___itemdetail.txt', 'file____190677463940___itemdetail.txt', 'file____200776871997___itemdetail.txt', 'file_blueinconline@GB_GB__320835010310___bestmatch.txt', 'file____190692613763___itemdetail.txt', 'file____190725215772___itemdetail.txt', 'file_blueinconline@GB_GB__200713867682___bestmatch.txt', 'file____190661023104___itemdetail.txt', 'file_blueinconline@GB_GB__320883576681___bestmatch.txt', 'file____190716864955___itemdetail.txt', 'file_blueinconline@GB_GB__190661025456___bestmatch.txt', 'file____200800462976___itemdetail.txt', 'file____200771969971___itemdetail.txt', 'file____200816632305___itemdetail.txt', 'file____320911481307___itemdetail.txt', 'file____190701649606___itemdetail.txt', 'file____200776602736___itemdetail.txt', 'file____200817799455___itemdetail.txt', 'file____200731450065___itemdetail.txt', 'file_blueinconline@GB_GB__200737019809___bestmatch.txt', 'file____320951880767___itemdetail.txt', 'file____320972712760___itemdetail.txt', 'file____190687549237___itemdetail.txt', 'file____200814941395___itemdetail.txt', 'file____320942174269___itemdetail.txt', 'file____200731450029___itemdetail.txt', 'file____200801722209___itemdetail.txt', 'file_blueinconline_GB_169291__5_0_item.txt', 'file____190685222263___itemdetail.txt', 'file_blueinconline_GB_57991__3_0_item.txt', 'file____200775627423___itemdetail.txt', 'benchclothing@GB', 'file_blueinconline_GB_15775__6_0_item.txt', 'file____190722921174___itemdetail.txt', 'file____200777743770___itemdetail.txt', 'file_blueinconline_GB_11555__52_0_item.txt', 'file____190721670238___itemdetail.txt', 'file____190724813129___itemdetail.txt', 'file____200812833660___itemdetail.txt', 'file____320917422005___itemdetail.txt', 'file____200793500581___itemdetail.txt', 'file____320980922216___itemdetail.txt', 'file____190687031728___itemdetail.txt', 'file____200794597832___itemdetail.txt', 'file____320989275446___itemdetail.txt', 'file_blueinconline_GB_____categories.txt', 'file____190711510271___itemdetail.txt', 'file____190699647760___itemdetail.txt', 'file____320980267916___itemdetail.txt', 'file____200809425071___itemdetail.txt', 'file_blueinconline_GB_15690__5_0_item.txt', 'file____190663694849___itemdetail.txt', 'file____200800533385___itemdetail.txt', 'file_blueinconline@GB_GB__200769243611___bestmatch.txt', 'file____320957936316___itemdetail.txt', 'file____200772523082___itemdetail.txt', 'file____190682146145___itemdetail.txt', 'file____320944323906___itemdetail.txt', 'file____320978370011___itemdetail.txt', 'file_blueinconline@GB_GB__190685222263___bestmatch.txt', 'file_blueinconline@GB_GB__190687013680___bestmatch.txt', 'file____190655651967___itemdetail.txt', 'file_blueinconline_GB_53557__106_0_item.txt', 'file____200812838365___itemdetail.txt', 'file____320924195456___itemdetail.txt', 'file____200814900270___itemdetail.txt', 'file____200798760389___itemdetail.txt', 'file____320955386350___itemdetail.txt', 'file_blueinconline@GB_GB__190661023104___bestmatch.txt', 'file____190703807269___itemdetail.txt', 'file____320889947005___itemdetail.txt', 'file____190725242465___itemdetail.txt', 'file____200800162733___itemdetail.txt', 'file____320976053893___itemdetail.txt', 'file_blueinconline_GB_15687__500_0_item.txt', 'file____200813156576___itemdetail.txt', 'file____200780489816___itemdetail.txt', 'file_blueinconline@GB_GB__190704015361___bestmatch.txt', 'file_blueinconline_GB_11538__1_0_item.txt', 'file____200790259003___itemdetail.txt', 'file_blueinconline@GB_GB__190682146145___bestmatch.txt', 'file____320982683134___itemdetail.txt', 'file____190684501988___itemdetail.txt', 'file____200769760847___itemdetail.txt', 'file_blueinconline_GB_45230__10_0_item.txt', 'file_blueinconline_GB_11846__1_0_item.txt', 'file____320960765974___itemdetail.txt', 'file_blueinconline_GB_155226__13_0_item.txt', 'file_blueinconline_GB_11554__43_0_item.txt', 'file____200824071564___itemdetail.txt', 'file_blueinconline@GB_GB__200787195879___bestmatch.txt', 'file____320946237673___itemdetail.txt', 'file____320901668195___itemdetail.txt', 'file_blueinconline_GB_15689__173_0_item.txt', 'file____190725283742___itemdetail.txt', 'file_blueinconline@GB_GB__320964823844___bestmatch.txt', 'file_blueinconline@GB_GB__200760381287___bestmatch.txt', 'file____320881770639___itemdetail.txt', 'file____200802619911___itemdetail.txt', 'file____320938009603___itemdetail.txt', 'file____190702157842___itemdetail.txt', 'file_blueinconline@GB_GB__190679386336___bestmatch.txt', 'file____320977247391___itemdetail.txt', 'file_blueinconline@GB_GB__320982127969___bestmatch.txt', 'file____190705403480___itemdetail.txt', 'file_blueinconline@GB_GB__190725590450___bestmatch.txt', 'file_blueinconline@GB_GB__320930200656___bestmatch.txt', 'file_blueinconline_GB_63861__87_0_item.txt', 'file____190668353574___itemdetail.txt', 'file_blueinconline_GB_11511__1_0_item.txt', 'file____320976033225___itemdetail.txt', 'file____190662624932___itemdetail.txt', 'file_blueinconline@GB_GB__320982091896___bestmatch.txt', 'file____190687582423___itemdetail.txt', 'file____190725617481___itemdetail.txt', 'file____200743833692___itemdetail.txt', 'file____190725598025___itemdetail.txt', 'file____190723305070___itemdetail.txt', 'file____320943604615___itemdetail.txt', 'file____190706829629___itemdetail.txt', 'file_blueinconline_GB_63862__99_0_item.txt', 'file____320956841094___itemdetail.txt', 'file____190722519386___itemdetail.txt', 'file____190707943846___itemdetail.txt', 'file_blueinconline_GB_3009__16_0_item.txt', 'file____190725669417___itemdetail.txt', 'file_blueinconline@GB_GB__190663694849___bestmatch.txt', 'file____200786892167___itemdetail.txt', 'file____320924195100___itemdetail.txt', 'file____190722110109___itemdetail.txt', 'file_blueinconline_GB_63867__18_0_item.txt', 'file____200787195879___itemdetail.txt', 'file____320931250740___itemdetail.txt', 'file____200815265011___itemdetail.txt', 'file____320964823844___itemdetail.txt', 'file____190725241028___itemdetail.txt', 'file____200824064482___itemdetail.txt', 'file____320919891989___itemdetail.txt', 'file_blueinconline_GB_63866__32_0_item.txt', 'file____200813211355___itemdetail.txt', 'file____190725615343___itemdetail.txt', 'file____190688961238___itemdetail.txt', 'file____200760381287___itemdetail.txt', 'file____200740291780___itemdetail.txt', 'file____190665736753___itemdetail.txt', 'file____190692108095___itemdetail.txt', 'file____320977747488___itemdetail.txt', 'file____200760030005___itemdetail.txt', 'file____190656451562___itemdetail.txt', 'file_blueinconline_GB_24087__219_0_item.txt', 'file____190724844342___itemdetail.txt', 'file____320948954413___itemdetail.txt', 'file____190722892818___itemdetail.txt', 'file____200791922275___itemdetail.txt', 'file____200777745981___itemdetail.txt', 'file____200813159595___itemdetail.txt','file____320956290977___itemdetail.txt', 'file_blueinconline_GB_11483__739_500_item.txt', 'file____190723307165___itemdetail.txt', 'file____190714480965___itemdetail.txt', 'file____200814969342___itemdetail.txt', 'file____200816228465___itemdetail.txt', 'file____190702180915___itemdetail.txt', 'file_blueinconline@GB_GB__190661020160___bestmatch.txt', 'file____190722926957___itemdetail.txt', 'file_blueinconline_GB_62107__39_0_item.txt', 'file____200776875323___itemdetail.txt', 'file____320973463351___itemdetail.txt', 'file_blueinconline@GB_GB__200794596388___bestmatch.txt', 'file____320872706155___itemdetail.txt', 'file____200818626037___itemdetail.txt', 'file____200816239797___itemdetail.txt', 'file____190725633161___itemdetail.txt', 'file____190691434619___itemdetail.txt', 'file____200778162367___itemdetail.txt', 'file____190704264385___itemdetail.txt', 'file____190663727007___itemdetail.txt', 'file____190720627337___itemdetail.txt', 'file____190685179547___itemdetail.txt', 'file_blueinconline@GB_GB__190725242465___bestmatch.txt', 'file_blueinconline@GB_GB__190712968453___bestmatch.txt', 'file____190726407298___itemdetail.txt', 'file_blueinconline_GB_57988__65_0_item.txt', 'file____200816637265___itemdetail.txt', 'file_blueinconline_GB_169001__15_0_item.txt', 'file____320946238773___itemdetail.txt', 'file____190723383361___itemdetail.txt', 'file____190661017970___itemdetail.txt', 'file____200773521598___itemdetail.txt', 'file____200807735809___itemdetail.txt', 'file____200818213586___itemdetail.txt', 'file____190703753916___itemdetail.txt', 'file____200815243890___itemdetail.txt', 'file____200748697331___itemdetail.txt', 'file_blueinconline@GB_GB__190677463940___bestmatch.txt', 'file____200801593564___itemdetail.txt', 'file____320957936421___itemdetail.txt', 'file____190655576829___itemdetail.txt', 'file____200793509559___itemdetail.txt', 'file_blueinconline_GB_53159__278_0_item.txt', 'file____200805050972___itemdetail.txt', 'file____320951341482___itemdetail.txt', 'file____320943457142___itemdetail.txt', 'file_blueinconline@GB_GB__320977747488___bestmatch.txt', 'file____200817799469___itemdetail.txt', 'file_blueinconline@GB_GB__320942174269___bestmatch.txt', 'file____200793564423___itemdetail.txt', 'file____190720203076___itemdetail.txt', 'file_blueinconline@GB_GB__190724844342___bestmatch.txt', 'file____200805000401___itemdetail.txt', 'file____190685249718___itemdetail.txt', 'file____190662305679___itemdetail.txt', 'file____190661026839___itemdetail.txt', 'file____200731505607___itemdetail.txt', 'file____200804705741___itemdetail.txt', 'file____320976062488___itemdetail.txt', 'file_blueinconline_GB_63889__5_0_item.txt', 'file____200817798850___itemdetail.txt', 'file____200786880804___itemdetail.txt', 'file____190698496501___itemdetail.txt', 'file_blueinconline_GB_15709__54_0_item.txt', 'file____190701165415___itemdetail.txt', 'file____200793619017___itemdetail.txt', 'file____320982127969___itemdetail.txt', 'file____200713867682___itemdetail.txt', 'file____190703756995___itemdetail.txt', 'file____320953313137___itemdetail.txt', 'file____200815355022___itemdetail.txt', 'file____320925648581___itemdetail.txt', 'file____190702186556___itemdetail.txt', 'file____190705034221___itemdetail.txt', 'file____320957400877___itemdetail.txt', 'file____200816567770___itemdetail.txt', 'file_blueinconline_GB_2993__41_0_item.txt', 'file____320982091896___itemdetail.txt', 'file____190679386336___itemdetail.txt', 'file_blueinconline_GB_57990__486_0_item.txt', 'file____200788277058___itemdetail.txt', 'file____190689904233___itemdetail.txt', 'file____320976034746___itemdetail.txt', 'file____320915654611___itemdetail.txt', 'file_blueinconline_GB_45333__95_0_item.txt', 'file____200798913410___itemdetail.txt', 'file____320976031160___itemdetail.txt', 'file_blueinconline_GB_1060__1_0_item.txt', 'file____200797792341___itemdetail.txt', 'file____200738930313___itemdetail.txt', 'file____320924463090___itemdetail.txt', 'file____320963258782___itemdetail.txt', 'file____200816150680___itemdetail.txt', 'file____200767952600___itemdetail.txt', 'file____320967627718___itemdetail.txt', 'file____320946318461___itemdetail.txt', 'file_blueinconline@GB_GB__200800462976___bestmatch.txt', 'file_blueinconline_GB_79720__1_0_item.txt', 'file_blueinconline_GB_55793__78_0_item.txt', 'file_blueinconline_GB_52357__7_0_item.txt', 'file____200817799443___itemdetail.txt', 'file____200776861946___itemdetail.txt', 'file____190694413944___itemdetail.txt', 'file____190720928947___itemdetail.txt', 'file_blueinconline@GB_GB__320976033225___bestmatch.txt', 'file____200818635801___itemdetail.txt', 'file_blueinconline_GB_11847__3_0_item.txt', 'file_blueinconline_GB_57989__203_0_item.txt', 'file____200797312934___itemdetail.txt', 'file_blueinconline_GB_15687__822_500_item.txt', 'file____320980199656___itemdetail.txt', 'file_blueinconline@GB_GB__200788277058___bestmatch.txt', 'file____190722122011___itemdetail.txt', 'file_blueinconline@GB_GB__190692613763___bestmatch.txt', 'file_blueinconline@GB_GB__190703756995___bestmatch.txt', 'file_blueinconline@GB_GB__200775522967___bestmatch.txt', 'file____190704015361___itemdetail.txt', 'file____320974038042___itemdetail.txt', 'file_blueinconline@GB_GB__200743851726___bestmatch.txt', 'file____190709338837___itemdetail.txt', 'file____190691435323___itemdetail.txt', 'file____190725670462___itemdetail.txt', 'file____200814885608___itemdetail.txt', 'file_blueinconline@GB_GB__190723759277___bestmatch.txt', 'file_blueinconline_GB_52365__7_0_item.txt', 'file____190707278514___itemdetail.txt', 'file____320925566095___itemdetail.txt', 'file____320973346899___itemdetail.txt', 'file_blueinconline_GB_63863__42_0_item.txt', 'file_blueinconline@GB_GB__190685554202___bestmatch.txt', 'file____190725967010___itemdetail.txt', 'file____200800481539___itemdetail.txt', 'file____200819124049___itemdetail.txt', 'file____320982122358___itemdetail.txt']
    #clear_files(['file_blueinconline_GB_11483__240_0_item.txt', 'file_blueinconline_GB_15687__88_0_item.txt', 'file_blueinconline_GB_15689__56_0_item.txt', 'file_blueinconline_GB_57989__163_0_item.txt', 'file_blueinconline_GB_57990__37_0_item.txt', 'file_superdrystore_GB_155226__314_0_item.txt', 'file_superdrystore_GB_53159__151_0_item.txt', 'file_superdrystore_GB_63862__299_0_item.txt', 'file_superdrystore_GB_63864__67_0_item.txt', 'file_superdrystore_GB_63869__303_0_item.txt'])
    loaddata_from_dump_to_mysql_and_clear_dumps(filenamelist=filenamelist)
    pass
